<?xml version="1.0" encoding="UTF-8"?>
<atlassian-plugin key="${atlassian.plugin.key}" name="${project.name}" plugins-version="2">
    <plugin-info>
        <description>${project.description}</description>
        <version>${project.version}</version>
        <vendor name="${project.organization.name}" url="${project.organization.url}" />
        <param name="atlassian-data-center-status">compatible</param>
        <param name="atlassian-data-center-compatible">true</param>
        <param name="configure.url">/plugins/servlet/onlyoffice/configure</param>

        <param name="plugin-icon">images/16.png</param>
        <param name="plugin-logo">images/144.png</param>
        <param name="plugin-banner">images/banner.jpg</param>
        <param name="vendor-icon">images/16.png</param>
        <param name="vendor-logo">images/72.png</param>
    </plugin-info>

    <resource type="i18n" name="i18n" location="lang-resource"/>

    <web-resource key="onlyoffice-confluence-plugin-resources" name="Web Resources container for main page">
        <resource type="download" name="onlyoffice-main.js" location="js/onlyoffice-main.js"/>
        <context>page</context>
    </web-resource>

    <web-resource key="onlyoffice-confluence-plugin-resources-configure" name="Web Resources container for configuration page">
        <resource type="download" name="configure.css" location="css/configure.css"/>
        <resource type="download" name="icon_view.svg" location="images/icon_view.svg"/>
        <resource type="download" name="icon_hide.svg" location="images/icon_hide.svg"/>
    </web-resource>

    <web-resource key="onlyoffice-confluence-plugin-resources-filecreate" name="Web Resources container for file creation dialog">
        <dependency>com.atlassian.auiplugin:ajs</dependency>
        <transformation extension="js">
            <transformer key="jsI18n"/>
        </transformation>
        <transformation extension="soy">
            <transformer key="soyTransformer">
                <functions>com.atlassian.confluence.plugins.soy:soy-core-functions</functions>
            </transformer>
        </transformation>
        <resource type="download" name="dialog-filecreate-soy.js" location="templates/dialog-filecreate.soy"/>
        <resource type="download" name="dialog-filecreate.js" location="js/dialog-filecreate.js"/>
        <resource type="download" name="dialog-filecreate.css" location="css/dialog-filecreate.css"/>
        <resource type="download" name="new-docx.svg" location="images/new-docx.svg"/>
        <resource type="download" name="new-xlsx.svg" location="images/new-xlsx.svg"/>
        <resource type="download" name="new-pptx.svg" location="images/new-pptx.svg"/>
        <resource type="download" name="confirm.svg" location="images/confirm.svg"/>
        <resource type="download" name="16.svg" location="images/16.svg"/>
        <condition class="onlyoffice.conditions.IsOfficePageAttachments"/>
        <context>page</context>
    </web-resource>

    <web-resource key="onlyoffice-confluence-plugin-resources-editor" name="Web Resources container for editor page">
        <dependency>com.atlassian.confluence.editor:page-editor-js</dependency>
        <dependency>com.atlassian.confluence.plugins.drag-and-drop:editor-drop-handler</dependency>
        <resource type="download" name="editor.css" location="css/editor.css"/>
        <resource type="download" name="text.ico" location="images/text.ico"/>
        <resource type="download" name="spreadsheet.ico" location="images/spreadsheet.ico"/>
        <resource type="download" name="presentation.ico" location="images/presentation.ico"/>
    </web-resource>

    <web-item key="onlyoffice-filecreate" name="New Document" section="system.content.button" weight="47">
        <condition class="onlyoffice.conditions.IsOfficePageAttachments"/>
        <icon height="16" width="16">
            <link>/download/resources/${project.groupId}.${project.artifactId}:onlyoffice-confluence-plugin-resources-filecreate/16.svg</link>
        </icon>
        <label key="onlyoffice.connector.createlink"/>
        <tooltip key="onlyoffice.connector.tooltip.createlink"/>
        <link linkId="onlyoffice-filecreate" absolute="true"/>
    </web-item>
    <web-item key="onlyoffice-doceditor" name="Link for the attachment editing" section="system.attachment" weight="9">
        <condition class="onlyoffice.conditions.IsOfficeFileAttachment">
            <param name="forEdit">true</param>
        </condition>
        <description>The link and the text for it which is used to open the document which is available for editing.</description>
        <label key="onlyoffice.connector.editlink"/>
        <link><![CDATA[/plugins/servlet/onlyoffice/doceditor?attachmentId=$attachment.id]]></link>
        <styleClass>onlyoffice-doceditor</styleClass>
    </web-item>
    <web-item key="onlyoffice-docviewer" name="Link for the attachment viewing" section="system.attachment" weight="10">
        <condition class="onlyoffice.conditions.IsOfficeFileAttachment"/>
        <description>The link and the text for it which is used to open the document which is available for preview only.</description>
        <label key="onlyoffice.connector.viewlink"/>
        <link><![CDATA[/plugins/servlet/onlyoffice/doceditor?attachmentId=$attachment.id]]></link>
        <styleClass>onlyoffice-doceditor</styleClass>
    </web-item>
    <web-item key="onlyoffice-docconvert" name="Link for the attachment conversion" section="system.attachment" weight="11">
        <condition class="onlyoffice.conditions.IsOfficeFileConvertAttachment"/>
        <description>The link and the text for it which is used to convert the document to Office Open XML format</description>
        <label key="onlyoffice.connector.convertlink"/>
        <link><![CDATA[/plugins/servlet/onlyoffice/convert?attachmentId=$attachment.id]]></link>
        <styleClass>onlyoffice-doceditor</styleClass>
    </web-item>

    <servlet key="OnlyOfficeDocEditor" class="onlyoffice.OnlyOfficeEditorServlet" name="Document Editor">
        <description>The fully functional editor for most known formats of text documents, spreadsheets and presentations used to open these types of documents for editing or preview.</description>
        <url-pattern>/onlyoffice/doceditor</url-pattern>
    </servlet>
    <servlet key="OnlyOfficeSaveFileHandler" class="onlyoffice.OnlyOfficeSaveFileServlet" name="Save File Handler">
        <description>The callback URL, used to inform the document storage service about the end of the document editing and return the link to the modified document so that it could be saved correctly.</description>
        <url-pattern>/onlyoffice/save</url-pattern>
    </servlet>
    <servlet key="OnlyOfficeConvertHandler" class="onlyoffice.OnlyOfficeConvertServlet" name="Convert Handler">
        <description>The convert URL, used to make a request to document editing service to convert file to a different format.</description>
        <url-pattern>/onlyoffice/convert</url-pattern>
    </servlet>
    <servlet key="OnlyOfficeConfigure" class="onlyoffice.OnlyOfficeConfServlet" name="Configuration Page">
        <description>The configuration page.</description>
        <url-pattern>/onlyoffice/configure</url-pattern>
    </servlet>
    <servlet key="OnlyOfficeHistory" class="onlyoffice.OnlyOfficeHistoryServlet" name="History Handler">
        <description>The history URL, to get history data.</description>
        <url-pattern>/onlyoffice/history</url-pattern>
    </servlet>
    <servlet key="OnlyOfficeFileProvider" class="onlyoffice.OnlyOfficeFileProviderServlet" name="File Provider Handler">
        <description>The File Provider URL, to get link to download file.</description>
        <url-pattern>/onlyoffice/file-provider</url-pattern>
    </servlet>
</atlassian-plugin>